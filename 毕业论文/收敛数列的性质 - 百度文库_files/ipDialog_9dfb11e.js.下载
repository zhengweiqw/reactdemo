define("wkcommon:widget/tb/ipDialog/ipDialog.js",function(e,s,a){var i=e("wkcommon:widget/lib/doT/doT.min.js"),n=i.template('<div class="ipdialog-mask">\n<div class="form-info-dialog">\n<div class="close j-info-close"></div>\n<div class="topbar">\n<p class="title">\u586b\u5199\u4fe1\u606f\u5b8c\u6210\u8ba4\u8bc1\u4eab\u53d7\u6743\u76ca</p>\n<ul class="auth">\n<li>\u65e0\u9650\u4e0b\u8f7d</li>\n<li>\u76f4\u63a5\u62f7\u8d1d</li>\n<li>\u5728\u7ebf\u5907\u8bfe\u7a7a\u95f4</li>\n</ul>\n</div>\n<div class="form-container">\n<div class="input-bd">\n<input type="text" name="school" class="input placeholder disable" placeholder="\u60a8\u7684\u5b66\u6821" value="\u60a8\u7684\u5b66\u6821" autocomplete="off" disableautocomplete disabled>\n<div class="error">\u4e0d\u80fd\u4e3a\u7a7a</div>\n</div>\n<div class="input-bd">\n<input type="text" name="name" class="input placeholder" placeholder="\u60a8\u7684\u59d3\u540d\uff08\u5fc5\u586b\uff09" value="\u60a8\u7684\u59d3\u540d\uff08\u5fc5\u586b\uff09" autocomplete="off" disableautocomplete>\n<div class="error">\u4e0d\u80fd\u4e3a\u7a7a</div>\n</div>\n<div class="input-bd">\n<input type="text" name="phone" class="input placeholder" placeholder="\u60a8\u7684\u624b\u673a\u53f7\uff08\u5fc5\u586b\uff09" value="\u60a8\u7684\u624b\u673a\u53f7\uff08\u5fc5\u586b\uff09" autocomplete="off" disableautocomplete>\n<div class="error">\u8bf7\u586b\u5199\u6b63\u786e\u624b\u673a\u53f7</div>\n</div>\n<div class="verify-code">\n<div class="input-bd code-bd">\n<input type="text" name="code" class="input placeholder" placeholder="\u586b\u5199\u9a8c\u8bc1\u7801" value="\u586b\u5199\u9a8c\u8bc1\u7801" autocomplete="off" disableautocomplete>\n<div class="error">\u9a8c\u8bc1\u7801\u8f93\u5165\u9519\u8bef</div>\n</div>\n<a class="code-btn j-send-code">\u53d1\u9001\u9a8c\u8bc1\u7801</a>\n</div>\n<p class="hint j-checkbox"><i class="checkbox"></i>\u6b64\u4fe1\u606f\u4ec5\u7528\u4e8e\u65b9\u4fbf\u60a8\u5728\u5bb6\u4f7f\u7528\u8d26\u53f7\uff0c\u540c\u610f\u540e\u8bf7\u52fe\u9009\u3002</p>\n<a href="javascript:;" class="submit-btn disable j-submit-btn">\u63d0\u4ea4</a>\n</div>\n</div>\n<div class="success-dialog">\n<div class="close j-close"></div>\n<div class="success-icon"></div>\n<p class="title">\u63d0\u4ea4\u6210\u529f</p>\n<p class="sub">\u60a8\u5df2\u8ba4\u8bc1\u5b8c\u6bd5\uff0c\u6b22\u8fce\u4f7f\u7528\u767e\u5ea6\u667a\u6167\u8bfe\u5802\uff01</p>\n<a href="javascript:;" class="btn j-close-btn">\u77e5\u9053\u4e86</a>\n</div>\n<div class="login-dialog">\n<div class="close j-close"></div>\n<p class="title">\u63d0\u4ea4\u6210\u529f\uff01<br>\u624b\u673a\u53f7\u767b\u5f55\u540e\uff0c\u7acb\u523b\u4eab\u53d7\u6743\u76ca</p>\n<p class="sub">\u8bf7\u4f7f\u7528\u521a\u624d\u63d0\u4ea4\u7684\u624b\u673a\u53f7\u8fdb\u884c\u767b\u5f55</p>\n<a href="https://study.baidu.com/phonelogin?backname=/K12" class="btn j-go-login" target="_blank">\u73b0\u5728\u53bb\u767b\u5f55</a>\n</div>\n</div>'),t=e("wkcommon:widget/ui/js_core/log/log.js"),o={init:function(e){var s=this;
s.tpl=n(),$(".ipdialog-mask").length<=0&&$("body").append(s.tpl),$(".ipdialog-mask").show(),$("body").css({height:"100%",overflow:"hidden"}),t.xsend(1,101893,{type:"show"}),this.pagetype=e.pagetype,this.schoolname=e.schoolname,this.orgId=e.orgId,this.docid=e.docid,this.schoolname&&$(".input[name=school]").val(this.schoolname).removeClass("placeholder"),"view"===this.pagetype&&$(".j-close-btn").html("\u53bb\u770b\u770b"),setTimeout(function(){s.bindEvent()},500)},bindEvent:function(){var e=this,s=!1,a=!1;
$(".ipdialog-mask .input").on("focus",function(e){var s=$(this),a=$(e.currentTarget),i=a.attr("placeholder"),n=a.val();n===i&&s.val(""),s.removeClass("placeholder")}),$(".ipdialog-mask .input").on("blur",function(e){var s=$(e.currentTarget),a=s.attr("placeholder"),i=s.val();""===i&&$(this).val(a).addClass("placeholder")}),$(".ipdialog-mask .input").on("input propertychange",function(){var e=!1;$(".input").not(".disable").each(function(){var s=$(this),a=s.attr("placeholder");""===s.val()||s.val()===a?($(".j-submit-btn").addClass("disable"),e=!0):s.parents(".input-bd").removeClass("error")
}),!e&&a&&$(".j-submit-btn").removeClass("disable")}),$(".j-send-code").on("click",function(){if(!s){var e=$(this),a=60,i=$("input[name=phone]"),n=i.val(),t=i.attr("placeholder");return""===n||n===t?void i.parents(".input-bd").addClass("error"):/^[1][3,4,5,6,7,8,9][0-9]{9}$/.test(n)?void $.ajax({url:"https://study.baidu.com/api/wenku/activity/send-message",type:"post",data:{phone:n},xhrFields:{withCredentials:!0},dataType:"json",success:function(i){if(0===i.error){s=!0,e.removeClass("resend").addClass("send"),e.html("\u5df2\u53d1\u9001\uff08"+a+"s\uff09");
var n=setInterval(function(){a--,e.html("\u5df2\u53d1\u9001\uff08"+a+"s\uff09"),0===a&&(clearInterval(n),s=!1,e.html("\u91cd\u65b0\u53d1\u9001\u9a8c\u8bc1\u7801").removeClass("send").addClass("resend"))},1e3)}else $("input[name=code]").parents(".input-bd").addClass("error").find(".error").html(i.errmsg)}}):void i.parents(".input-bd").addClass("error")}}),$(".j-submit-btn").on("click",function(){t.xsend(1,101895,{type:"click"});var s=!0;$(".input").not(".disable").each(function(){var e=$(this),a=e.attr("placeholder");
""===e.val()||e.val()===a?(e.parents(".input-bd").addClass("error"),s=!1):e.parents(".input-bd").removeClass("error")});var i=$("input[name=phone]");if(/^[1][3,4,5,6,7,8,9][0-9]{9}$/.test(i.val())||(i.parents(".input-bd").addClass("error"),s=!1),s&&a){var n={name:$("input[name=name]").val(),phone:$("input[name=phone]").val(),dynamic_psw:$("input[name=code]").val(),org_id:e.orgId};$.ajax({url:"https://study.baidu.com/api/wenku/activity/phone-verify",type:"post",data:n,xhrFields:{withCredentials:!0},dataType:"json",success:function(e){if(0===e.error){t.xsend(1,101901,{type:"click"}),document.cookie="havesendipverify=1;domain=.baidu.com;path=/",$(".form-info-dialog").hide();
var s,a=e.data,i=8,n=navigator.userAgent.toLowerCase(),o=n.indexOf("msie")>-1;o&&(s=n.match(/msie ([\d.]+)/)[1]),a?$(".success-dialog").show():i>=s?$(".success-dialog").show():$(".login-dialog").show()}else $("input[name=code]").parents(".input-bd").addClass("error").find(".error").html(6===e.error||2403===e.error||2405===e.error?e.errmsg:"\u53c2\u6570\u6709\u8bef\uff0c\u8bf7\u5411\u5b66\u6821\u7ba1\u7406\u5458\u53cd\u9988")}})}}),$(".j-go-login").on("click",function(){e.close(),t.xsend(1,101904,{type:"click"})
}),$(".j-close-btn").on("click",function(){e.close(),"view"===e.pagetype&&window.open("https://study.baidu.com/view/"+e.docid),t.xsend(1,101903,{type:"click",from:e.pagetype})}),$(".ipdialog-mask .close").on("click",function(){e.close()}),$(".j-info-close").on("click",function(){t.xsend(1,101894,{type:"click"})}),$(".j-checkbox").on("click",function(){if(a)$(".j-submit-btn").addClass("disable"),$(this).removeClass("checked");else{var e=!0;$(".input").not(".disable").each(function(){var s=$(this),a=s.attr("placeholder");
(""===s.val()||s.val()===a)&&(e=!1)}),e&&$(".j-submit-btn").removeClass("disable"),$(this).addClass("checked")}a=!a}),$(".j-close").on("click",function(){t.xsend(1,101902,{type:"click"})})},close:function(){$(".ipdialog-mask").hide(),$("body").css({height:"auto",overflow:"auto"})}};a.exports=o});