define("wkcommon:widget/sessionX/sessionX.js",function(t,e,n){var i=t("wkcommon:widget/ui/lib/jquery/jquery.js"),s=t("wkcommon:widget/lib/third_party/md5/md5.js"),r=t("wkcommon:widget/ui/js_core/log/log.js"),o=function(t){this.data=t||{}};o.prototype={constructor:o,data:{},set:function(t){return this.data=t,this},get:function(){return this.data},setItem:function(t,e){return this.data[t]=e,this},getItem:function(t){return this.data[t]},toString:function(){return"lifeInfo: "+JSON.stringify(this.data)
}};var a=function(t){this.data=t||{}};a.prototype={constructor:a,data:{},set:function(t){return this.data=t,this},get:function(){return this.data},setItem:function(t,e){return this.data[t]=e,this},getItem:function(t){return this.data[t]},toString:function(){return"urlParam: "+JSON.stringify(this.data)}};var f=function(t,e){t instanceof a||(t=new a),e instanceof o||(e=new o),this.urlParam=t,this.lifeInfo=e};f.prototype={constructor:f,urlParam:{},lifeInfo:{},get:function(){return{urlParam:this.urlParam.get(),lifeInfo:this.lifeInfo.get()}
},setUrlParm:function(t){return t instanceof a?(this.urlParam=t,this):void 0},setLifeInfo:function(t){t instanceof o&&(this.lifeInfo=t)},getUrlParm:function(){return this.urlParam},getLifeInfo:function(){return this.lifeInfo},toString:function(){return[this.urlParam.toString(),this.lifeInfo.toString()].join("; ")}};var u=function(){this.syncFromStorage(),this.updateStorage()};u.prototype={constructor:u,mapSessionEntry:{},mapPageLifeKey:{},session:{},getSessionItem:function(t){return this.session[t]
},setSessionItem:function(t,e){this.session[t]=e,this.updateStorage()},getMapSessionEntry:function(){return this.mapSessionEntry},getMapSessionEntryItem:function(t){return this.mapSessionEntry[t]},setMapSessionEntryItem:function(t,e){e instanceof f&&(this.mapSessionEntry[t]=e,this.updateStorage())},removeMapSessionEntryItem:function(t){delete this.mapSessionEntry[t],this.updateStorage()},removeAllMapSessionEntry:function(){this.mapSessionEntry={},this.updateStorage()},getMapPageLifeKeyItem:function(t){return this.mapPageLifeKey[t]
},setMapPageLifeKeyItem:function(t,e){this.mapPageLifeKey[t]=e,this.updateStorage()},removeMapPageLifeKeyItem:function(t){delete this.mapPageLifeKey[t],this.updateStorage()},createUrlParam:function(t,e){var n,r={sxts:+new Date};n=e.indexOf("?")>-1?e+"&"+i.param(r):e+"?"+i.param(r);var o=s(n),u=new a(t),m=new f(u);return this.setMapSessionEntryItem(o,m),n},getUrlParam:function(){var t=s(window.location.href),e=this.getMapSessionEntryItem(t);if(void 0===e||!(e instanceof f))return{};var n=e.getUrlParm();
return void 0!==n&&n instanceof a?n.get():{}},syncFromStorage:function(){var t=sessionStorage.getItem("SessionX");if(t){var e=JSON.parse(t),n=e.mapSessionEntry;for(var i in n){if(!n.hasOwnProperty(i))return;var s=e.mapSessionEntry[i],r=new a(s.urlParam),u=new o(s.lifeInfo);this.mapSessionEntry[i]=new f(r,u)}this.mapPageLifeKey=e.mapPageLifeKey||{},this.session=e.session||{}}},updateStorage:function(){var t={};for(var e in this.mapSessionEntry)if(this.mapSessionEntry.hasOwnProperty(e)){var n=this.mapSessionEntry[e];
t[e]=n.get()}var i={mapSessionEntry:t,mapPageLifeKey:this.mapPageLifeKey,session:this.session};try{sessionStorage.setItem("SessionX",JSON.stringify(i))}catch(s){r.xsend(1,101578),console.error(s)}}};var m=new u,c={init:function(){this.pureSessionX().bindMousedown()},pureSessionX:function(){var t=s(window.location.href),e=m.getMapSessionEntryItem(t);return void 0!==e&&e instanceof f?(m.removeAllMapSessionEntry(),m.setMapSessionEntryItem(t,e),this):this},bindMousedown:function(){return i(window).on("mousedown",".sessionX",function(){var t=i(this),e=t.data(),n=JSON.parse(e.sessionXSession)||{},s=JSON.parse(e.sessionXUrlParam)||{};
i.each(n,function(t,e){m.setSessionItem(t,e)});var r=t.prop("href"),o=m.createUrlParam(s,r);t.prop("href",o)}),this}};c.init(),n.exports={LifeInfo:o,UrlParam:a,SessionEntry:f,sessionXMgr:m}});