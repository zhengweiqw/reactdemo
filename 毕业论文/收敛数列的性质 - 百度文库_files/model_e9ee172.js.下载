define("wkview:widget/commerce/fengchao/model.js",function(e,r,o){function c(){var e=n.get("WkInfo").DocInfo||{},r=e.title||"";return""===r&&console.error("fc recom got empty query"),r}var n=e("wkcommon:widget/lib/fis/data/data.js"),d=e("wkcommon:widget/ui/js_core/log/log.js"),t="https://wenku.baidu.com",a=0,f=[],s=null,i=!1;o.exports.fetchData=function(e){var r=new $.Deferred;return 0===a?(a=1,$.ajax({url:t+"/common/fc/pc/view_recom",dataType:"json",data:{url:location.href,query:c()},success:function(o){if(0===o.code){for($.map(o.data,function(o){o.srcId===e&&r.resolve(o.adPlace)});f.length>0;){var c=f.pop();$.map(o.data,function(e){e.srcId===c.srcId&&c.defer.resolve(e.adPlace)})}s=o.data,i=!0,d.xsend(1,101912,{index:1})}else if(1001===o.code){for(d.xsend(1,101912,{index:2}),console.error("fc recom data error");f.length>0;){var c=f.pop();c.defer.reject(o.code)}r.reject(o.code)}else if(1002===o.code)d.xsend(1,101912,{index:3}),console.error("fc recom data error");else if(1003===o.code){for(d.xsend(1,101912,{index:4}),console.warn("fc recom recall failed");f.length>0;){var c=f.pop();c.defer.reject(o.code)}r.reject(o.code)}else{for(d.xsend(1,101912,{index:5}),console.error("fc recom data error");f.length>0;){var c=f.pop();c.defer.reject(o.code)}r.reject(o.code)}a=2},fail:function(){for(d.xsend(1,101912,{index:6}),console.error("fc recom api network error");f.length>0;){var e=f.pop();e.defer.reject(-1)}r.reject(-1)}})):1===a?f.push({defer:r,srcId:e}):2===a&&(i?setTimeout(function(){$.map(s,function(o){o.srcId===e&&r.resolve(o.adPlace)})},0):r.reject(-1)),r}});