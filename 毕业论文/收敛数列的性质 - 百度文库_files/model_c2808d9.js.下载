define("wkview:widget/commerce/pinzhuan/model.js",function(e,r,o){function t(){var e=c.get("WkInfo").DocInfo||{},r=e.title||"";return""===r&&console.error("pz got empty query"),r}var c=e("wkcommon:widget/lib/fis/data/data.js"),n="https://wenku.baidu.com",a=0,f=[],d=null,i=!1;o.exports.fetchData=function(e){var r=new $.Deferred;return 0===a?(a=1,$.ajax({url:n+"/common/fc/pc/pz_view",dataType:"json",data:{url:location.href,query:t()},success:function(o){if(0===o.code){var t=!1;for($.map(o.data,function(o){o.srcId===e&&(t=!0,r.resolve(o))}),t||r.reject(-1);f.length>0;){var c=f.pop(),t=!1;$.map(o.data,function(e){e.srcId===c.srcId&&(t=!0,c.defer.resolve(e))}),t||c.defer.reject(-1)}d=o.data,i=!0}else{for(console.error("pz server data error");f.length>0;){var c=f.pop();c.defer.reject(o.code)}r.reject(o.code)}a=2},fail:function(){for(console.error("pz api network error");f.length>0;){var e=f.pop();e.defer.reject(-1)}r.reject(-1)},error:function(){for(console.error("pz api network error");f.length>0;){var e=f.pop();e.defer.reject(-1)}r.reject(-1)}})):1===a?f.push({defer:r,srcId:e}):2===a&&(i?setTimeout(function(){var o=!1;$.map(d,function(t){t.srcId===e&&(o=!0,r.resolve(t))}),o||r.reject(-1)},0):r.reject(-1)),r}});